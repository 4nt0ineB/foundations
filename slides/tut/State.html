<!DOCTYPE html>
<html>
<head>
<title>State</title>
<meta charset="utf-8">
<style>
@import url(https://fonts.googleapis.com/css?family=Yanone+Kaffeesatz);
@import url(https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic);
@import url(https://fonts.googleapis.com/css?family=Ubuntu+Mono:400,700,400italic);

body { font-family: 'Droid Serif'; }
h1, h2, h3 {
font-family: 'Yanone Kaffeesatz';
font-weight: normal;
}
.remark-code, .remark-inline-code { font-family: 'Ubuntu Mono'; }
</style>
</head>
<body>
<textarea id="source">

class: center, middle

# State
`@JulienTruffaut`

---
# Variable

```tut:silent
var count: Int = 0

def inc(n: Int): Int = {
  count += n
  count
}
```

--

```tut
inc(5)
inc(2)
inc(5)
```

---
# Random number generator

```tut:silent
var seed: Int = 10

def genInt: Int = {
  seed = 7 * seed % 11
  seed
}
```

--

```tut
genInt
genInt
genInt
```

---
# State

```tut:silent
case class State[S, A](run: S => (S, A))
```

--

```tut:silent
val inc = State[Int, Unit](s => (s + 1, ()))
```

--

```tut
inc.run(2)
inc.run(10)
```

---
# FlatMap

```tut:silent
case class State[S, A](run: S => (S, A)) {
  def flatMap[B](f: A => State[S, B]): State[S, B] =
    State[S, B]{ s1 =>
       val (s2, a) = run(s1)
       f(a).run(s2)
    }
}
```

--

```tut:invisible
val inc = State[Int, Unit](s => (s + 1, ()))
```

--

```tut
inc.flatMap(_ => inc).run(10)
```

---
# FlatMap


```tut:invisible
case class State[S, A](run: S => (S, A)) {
  def flatMap[B](f: A => State[S, B]): State[S, B] =
    State[S, B]{ s1 =>
       val (s2, a) = run(s1)
       f(a).run(s2)
    }

  def map[B](f: A => B): State[S, B] =
    State[S, B]{ s1 =>
      val (s2, a) = run(s1)
      (s2, f(a))
    }
}
```

```tut:silent
val inc = State[Int, Unit](s => (s + 1, ()))

val double = State[Int, Unit](s => (s * 2, ()))

def modulo(n: Int) = State[Int, Unit](s => (s % n, ()))
```

--


```tut:silent
val expr = for {
  _ <- inc
  _ <- double
  _ <- inc
  _ <- modulo(3)
} yield ()
```

--

```tut
expr.run(10)
expr.run(5)
```


</textarea>
<script src="https://remarkjs.com/downloads/remark-latest.min.js">
</script>
<script>
    var slideshow = remark.create({
        ratio: "16:9"
    });
</script>
</body>
</html>